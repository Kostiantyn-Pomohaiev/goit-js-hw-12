{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function getPhotos(q, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get('', {\n      params: {\n        key: '44946850-4c776fe0ffa968f959f660738',\n        q,\n        page,\n        per_page: perPage,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Fetch error: ', error);\n    throw error;\n  }\n}","\nimport axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function getPhotos(q, page = 1, perPage = 15) {\n  try {\n    const response = await axios.get('', {\n      params: {\n        key: '44946850-4c776fe0ffa968f959f660738',\n        q,\n        page,\n        per_page: perPage,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Fetch error: ', error);\n    throw error;\n  }\n}\n","\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// import { createMarkup } from './js/render-functions';\nimport { getPhotos } from './js/pixabay-api';\n\n// ===============================================\n\nconst refs = {\n  form: document.querySelector('.form'),\n  btnSearch: document.querySelector('.btn-search'),\n  imgList: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  btnLoad: document.querySelector('.btn-load'),\n};\n\nlet lightbox;\nlet searchQuery = '';\nlet page = 1;\nconst perPage = 15;\n\n// ===============================================\n\nrefs.form.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  searchQuery = e.target.elements.text.value.trim();\n\n  if (!searchQuery) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  showLoader();\n  hideMoreBtn();\n  refs.imgList.innerHTML = '';\n  page = 1;\n\n  try {\n    const res = await getPhotos(searchQuery, page, perPage);\n\n    if (res.hits.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'bottomRight',\n      });\n      return;\n    }\n\n    // refs.imgList.innerHTML = createMarkup(res.hits);\n    // if (lightbox) {\n    //   lightbox.refresh();\n    // } else {\n    //   lightbox = new SimpleLightbox('.gallery-link', {\n    //     captionsData: 'alt',\n    //     captionDelay: 250,\n    //   });\n    // }\n\n    if (res.totalHits > perPage) {\n      showMoreBtn();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'bottomRight',\n    });\n    console.error('Fetch error: ', error);\n  } finally {\n    hideLoader();\n  }\n\n  e.target.reset();\n});\n\n// ===============================================\n\nrefs.btnLoad.addEventListener('click', async () => {\n  page += 1;\n\n  showLoader();\n  hideMoreBtn();\n\n  try {\n    const res = await getPhotos(searchQuery, page, perPage);\n\n    refs.imgList.insertAdjacentHTML('beforeend', createMarkup(res.hits));\n    lightbox.refresh();\n    scrollBy();\n\n    const loadedImages = page * perPage;\n    if (loadedImages >= res.totalHits) {\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'bottomRight',\n      });\n    } else {\n      showMoreBtn();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there was an error loading more images. Please try again later.',\n      position: 'bottomRight',\n    });\n    console.error('Fetch error: ', error);\n  } finally {\n    hideLoader();\n  }\n});\n\nfunction showLoader() {\n  refs.loader.classList.remove('hidden');\n}\nfunction hideLoader() {\n  refs.loader.classList.add('hidden');\n}\nfunction showMoreBtn() {\n  refs.btnLoad.classList.remove('hidden');\n}\nfunction hideMoreBtn() {\n  refs.btnLoad.classList.add('hidden');\n}\n\nfunction scrollBy() {\n  const cardHeight =\n    refs.imgList.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","getPhotos","q","page","perPage","error","refs","lightbox","searchQuery","e","iziToast","showLoader","hideMoreBtn","res","showMoreBtn","hideLoader","scrollBy","cardHeight"],"mappings":"6vBACAA,EAAM,SAAS,QAAU,2BAElB,eAAeC,EAAUC,EAAGC,EAAO,EAAGC,EAAU,GAAI,CACzD,GAAI,CAYF,OAXiB,MAAMJ,EAAM,IAAI,GAAI,CACnC,OAAQ,CACN,IAAK,qCACL,EAAAE,EACA,KAAAC,EACA,SAAUC,EACV,WAAY,QACZ,YAAa,aACb,WAAY,EACb,CACP,CAAK,GACe,IACjB,OAAQC,EAAO,CACd,cAAQ,MAAM,gBAAiBA,CAAK,EAC9BA,CACP,CACH,CCnBAL,EAAM,SAAS,QAAU,2BCUzB,MAAMM,EAAO,CACX,KAAM,SAAS,cAAc,OAAO,EACpC,UAAW,SAAS,cAAc,aAAa,EAC/C,QAAS,SAAS,cAAc,UAAU,EAC1C,OAAQ,SAAS,cAAc,SAAS,EACxC,QAAS,SAAS,cAAc,WAAW,CAC7C,EAEA,IAAIC,EACAC,EAAc,GACdL,EAAO,EACX,MAAMC,EAAU,GAIhBE,EAAK,KAAK,iBAAiB,SAAU,MAAMG,GAAK,CAK9C,GAJAA,EAAE,eAAc,EAEhBD,EAAcC,EAAE,OAAO,SAAS,KAAK,MAAM,OAEvC,CAACD,EAAa,CAChBE,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+BACT,SAAU,UAChB,CAAK,EACD,MACD,CAEDC,IACAC,IACAN,EAAK,QAAQ,UAAY,GACzBH,EAAO,EAEP,GAAI,CACF,MAAMU,EAAM,MAAMZ,EAAUO,EAAaL,EAAMC,CAAO,EAEtD,GAAIS,EAAI,KAAK,SAAW,EAAG,CACzBH,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,aAClB,CAAO,EACD,MACD,CAYGG,EAAI,UAAYT,GAClBU,GAEH,OAAQT,EAAO,CACdK,EAAS,MAAM,CACb,MAAO,QACP,QACE,2EACF,SAAU,aAChB,CAAK,EACD,QAAQ,MAAM,gBAAiBL,CAAK,CACxC,QAAY,CACRU,GACD,CAEDN,EAAE,OAAO,OACX,CAAC,EAIDH,EAAK,QAAQ,iBAAiB,QAAS,SAAY,CACjDH,GAAQ,EAERQ,IACAC,IAEA,GAAI,CACF,MAAMC,EAAM,MAAMZ,EAAUO,EAAaL,EAAMC,CAAO,EAEtDE,EAAK,QAAQ,mBAAmB,YAAa,aAAaO,EAAI,IAAI,CAAC,EACnEN,EAAS,QAAO,EAChBS,IAEqBb,EAAOC,GACRS,EAAI,UACtBH,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,6DACT,SAAU,aAClB,CAAO,EAEDI,GAEH,OAAQT,EAAO,CACdK,EAAS,MAAM,CACb,MAAO,QACP,QACE,yEACF,SAAU,aAChB,CAAK,EACD,QAAQ,MAAM,gBAAiBL,CAAK,CACxC,QAAY,CACRU,GACD,CACH,CAAC,EAED,SAASJ,GAAa,CACpBL,EAAK,OAAO,UAAU,OAAO,QAAQ,CACvC,CACA,SAASS,GAAa,CACpBT,EAAK,OAAO,UAAU,IAAI,QAAQ,CACpC,CACA,SAASQ,GAAc,CACrBR,EAAK,QAAQ,UAAU,OAAO,QAAQ,CACxC,CACA,SAASM,GAAc,CACrBN,EAAK,QAAQ,UAAU,IAAI,QAAQ,CACrC,CAEA,SAASU,GAAW,CAClB,MAAMC,EACJX,EAAK,QAAQ,kBAAkB,sBAAqB,EAAG,OACzD,OAAO,SAAS,CACd,IAAKW,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}